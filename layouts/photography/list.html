{{- define "main" }}
<div class="wrapper">
    <section class="home-photography" style="margin-top: 2rem;">
        <h1>{{ .Title }}</h1>
        <div class="photo-grid">
            {{- range .Pages }}
            {{- $img := .Resources.GetMatch "*.{jpg,jpeg,png,webp}" }}
            {{- if $img }}
            <a href="{{ $img.RelPermalink }}" class="photo-thumb-link no-underline" data-alt="{{ with .Params.alt }}{{ . }}{{ else }}{{ .Title }}{{ end }}">
                {{- $thumb := $img.Fill "300x300 q85" }}
                <img src="{{ $thumb.RelPermalink }}" alt="{{ with .Params.alt }}{{ . }}{{ else }}{{ .Title }}{{ end }}" class="photo-thumb" loading="lazy" />
            </a>
            {{- end }}
            {{- end }}
        </div>
    </section>
</div>
{{- if gt (len .Pages) 0 }}
<div id="lightbox" class="lightbox-overlay" aria-hidden="true">
    <button class="lightbox-close" aria-label="Close lightbox">&times;</button>
    <img class="lightbox-img" src="" alt="" />
</div>
<script>
(function() {
    var overlay = document.getElementById('lightbox');
    var img = overlay.querySelector('.lightbox-img');
    var closeBtn = overlay.querySelector('.lightbox-close');

    document.querySelectorAll('.photo-thumb-link').forEach(function(link) {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            img.src = this.href;
            img.alt = this.dataset.alt || '';
            overlay.classList.add('active');
            overlay.setAttribute('aria-hidden', 'false');
        });
    });

    function closeLightbox() {
        overlay.classList.remove('active');
        overlay.setAttribute('aria-hidden', 'true');
        img.src = '';
    }

    closeBtn.addEventListener('click', closeLightbox);
    overlay.addEventListener('click', function(e) {
        if (e.target === overlay) closeLightbox();
    });
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && overlay.classList.contains('active')) closeLightbox();
    });
})();
</script>
{{- end }}
{{- end }}
